# Opal

**Opal is a ruby to javascript compiler.** Opal aims to take ruby files
and generate efficient javascript that maintains rubys features. Opal
will, by default, generate fast and efficient code in preference to
keeping all ruby features.

Opal comes with an implementation of the ruby corelib, written in ruby,
that uses a bundled runtime (written in javascript) that tie all the
features together. Whenever possible Opal bridges to native javascript
features under the hood. The Opal gem includes the compiler used to
convert ruby sources into javascript.

Opal is [hosted on github](http://github.com/adambeynon/opal), and there
is a Freenode IRC channel at `#opal`.

## Downloads

The Opal runtime and corelib are distributed here, and are required to
run any code generated by opal.

**Production** version to be used in real apps/sites.

[Production version 0.3.15](http://opalrb.org/opal.js) _(120kb
Uncompressed, 13.7kb Minified And Gzipped)_

**Debug** version adds a lot of additional debug code. See the debug
section below.

[Debug version 0.3.15](http://opalrb.org/opal.debug.js) _(183kb
Uncompressed)_

## Installation

Opal comes distributed as a gem, so either install with:

```
gem install opal
```

Or add to your Gemfile:

``` ruby
gem "opal"
```

## Usage

Opal provides an **opal** command which can be used to compile ruby
sources into javascript. These can then be used in any
browser/javascript environment. Opal also comes with the ability to
run files direcly using [therubyracer](http://github.com/cowboyd/therubyracer), 
which is a gem to embed v8 into ruby. This also allows Opal to provide a
REPL to run ruby code directly against the Opal runtime.

### REPL

To run the ruby repl, simply run:

```
opal
```

from the command line. To exit, type `exit`.

### Running a ruby file

Opal can compile/eval any ruby file inside the v8 context by simply
passing a path to run:

```
opal path/to/file.rb
```

Try running some code with puts statements.

### Compiling Ruby Sources

If you have a ruby source foo.rb:

``` ruby
# foo.rb
puts "Wow, running ruby"
```

Compile it into `foo.js` using:

```
opal -c foo.rb
```

The generated code includes a wrapper which will register the file
with opal. Opal maintains an internal file system to make `require()`
work as expected. You will see this in the output:

``` js
// foo.js
opal.file('/foo.rb', function() {
  // compiled ruby code
});
```

This file is not enough to run by itself. It depends on `opal.js` which
can be downloaded above. Finally, compiling a ruby source creates a
wrapper around the code which will register the file with the opal
runtime. To actually load this code, you can use the `main()` function:

``` js
opal.main('/foo.rb');
```

These files can be added to a HTML page:

``` html
<!DOCTYPE html>
<html>
  <head>
    <script src="opal.js"></script>
    <script src="foo.js"></script>
    <script>
      opal.main('/foo.rb');
    </script>
  </head>
  <body>

  </body>
</html>
```

Open this file and check out the browsers' console.

## Change Log

### Edge

* Added HEREDOCS support in parser
* Parser now handles masgn (mass/multi assignments)
* More useful DependencyBuilder class to build gems dependencies
* Blocks no longer passed as an argument in method calls

### 0.3.15

Initial Release.
