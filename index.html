<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <title>Opal</title>
  <link rel="stylesheet" href="syntax.css" type="text/css" media="screen" charset="utf-8">
  <link rel="stylesheet" href="styles.css" type="text/css" media="screen" charset="utf-8">
</head>
<body>
  <div class="content">
<h1>Opal</h1>

<p><strong>Opal is a ruby to javascript compiler.</strong> Opal aims to take ruby files
and generate efficient javascript that maintains rubys features. Opal
will, by default, generate fast and efficient code in preference to
keeping all ruby features.</p>

<p>Opal comes with an implementation of the ruby corelib, written in ruby,
that uses a bundled runtime (written in javascript) that tie all the
features together. Whenever possible Opal bridges to native javascript
features under the hood. The Opal gem includes the compiler used to
convert ruby sources into javascript.</p>

<p>Opal is <a href="http://github.com/adambeynon/opal">hosted on github</a>, and there
is a Freenode IRC channel at <code>#opal</code>.</p>

<h2>Downloads</h2>

<p>The Opal runtime and corelib are distributed here, and are required to
run any code generated by opal.</p>

<p><strong>Production</strong> version to be used in real apps/sites.</p>

<p><a href="http://opalrb.org/opal.js">Production version 0.3.15</a> <em>(120kb
Uncompressed, 13.7kb Minified And Gzipped)</em></p>

<p><strong>Debug</strong> version adds a lot of additional debug code. See the debug
section below.</p>

<p><a href="http://opalrb.org/opal.debug.js">Debug version 0.3.15</a> <em>(183kb
Uncompressed)</em></p>

<h2>Installation</h2>

<p>Opal comes distributed as a gem, so either install with:</p>
<div class="highlight"><pre>gem install opal
</pre>
</div>

<p>Or add to your Gemfile:</p>
<div class="highlight"><pre><span class="n">gem</span> <span class="s2">&quot;opal&quot;</span>
</pre>
</div>

<h2>Usage</h2>

<p>Opal provides an <strong>opal</strong> command which can be used to compile ruby
sources into javascript. These can then be used in any
browser/javascript environment. Opal also comes with the ability to
run files direcly using <a href="http://github.com/cowboyd/therubyracer">therubyracer</a>, 
which is a gem to embed v8 into ruby. This also allows Opal to provide a
REPL to run ruby code directly against the Opal runtime.</p>

<h3>REPL</h3>

<p>To run the ruby repl, simply run:</p>
<div class="highlight"><pre>opal
</pre>
</div>

<p>from the command line. To exit, type <code>exit</code>.</p>

<h3>Running a ruby file</h3>

<p>Opal can compile/eval any ruby file inside the v8 context by simply
passing a path to run:</p>
<div class="highlight"><pre>opal path/to/file.rb
</pre>
</div>

<p>Try running some code with puts statements.</p>

<h3>Compiling Ruby Sources</h3>

<p>If you have a ruby source foo.rb:</p>
<div class="highlight"><pre><span class="c1"># foo.rb</span>
<span class="nb">puts</span> <span class="s2">&quot;Wow, running ruby&quot;</span>
</pre>
</div>

<p>Compile it into <code>foo.js</code> using:</p>
<div class="highlight"><pre>opal -c foo.rb
</pre>
</div>

<p>The generated code includes a wrapper which will register the file
with opal. Opal maintains an internal file system to make <code>require()</code>
work as expected. You will see this in the output:</p>
<div class="highlight"><pre><span class="c1">// foo.js</span>
<span class="nx">opal</span><span class="p">.</span><span class="nx">file</span><span class="p">(</span><span class="s1">&#39;/foo.rb&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// compiled ruby code</span>
<span class="p">});</span>
</pre>
</div>

<p>This file is not enough to run by itself. It depends on <code>opal.js</code> which
can be downloaded above. Finally, compiling a ruby source creates a
wrapper around the code which will register the file with the opal
runtime. To actually load this code, you can use the <code>main()</code> function:</p>
<div class="highlight"><pre><span class="nx">opal</span><span class="p">.</span><span class="nx">main</span><span class="p">(</span><span class="s1">&#39;/foo.rb&#39;</span><span class="p">);</span>
</pre>
</div>

<p>These files can be added to a HTML page:</p>
<div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;opal.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;foo.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script&gt;</span>
      <span class="nx">opal</span><span class="p">.</span><span class="nx">main</span><span class="p">(</span><span class="s1">&#39;/foo.rb&#39;</span><span class="p">);</span>
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>

  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre>
</div>

<p>Open this file and check out the browsers&#39; console.</p>

<h2>Change Log</h2>

<h3>Edge</h3>

<ul>
<li>Added HEREDOCS support in parser</li>
<li>Parser now handles masgn (mass/multi assignments)</li>
<li>More useful DependencyBuilder class to build gems dependencies</li>
<li>Blocks no longer passed as an argument in method calls</li>
</ul>

<h3>0.3.15</h3>

<p>Initial Release.</p>
</div>
</body>
</html>
